/*
jQWidgets v2.6.1 (2013-Jan-18)
Copyright (c) 2011-2013 jQWidgets.
License: http://jqwidgets.com/license/
*/

(function(a){a.extend(a.jqx._jqxGrid.prototype,{_updatefilterrowui:function(f){var l=this.columns.records.length;var e=0;for(var h=0;h<l;h++){var g=this.columns.records[h];var c=g.width;if(c<g.minwidth){c=g.minwidth}if(c>g.maxwidth){c=g.maxwidth}var k=a(this.filterrow[0].cells[h]);k.css("left",e);var i=true;if(k.width()==c){i=false}if(f){i=true}k.width(c);k[0].left=e;if(!(g.hidden&&g.hideable)){e+=c}else{k.css("display","none")}if(!i){continue}if(g.createfilterwidget&&g.filtertype=="custom"){g.createfilterwidget(g,k)}else{if(g.filterable){var d=function(m,n){var j=a(n.children()[0]);j.width(c-10)};switch(g.filtertype){case"number":a(k.children()[0]).width(c);k.find("input").width(c-30);break;case"date":if(this.host.jqxDateTimeInput){a(k.children()[0]).jqxDateTimeInput({width:c-10})}else{d(this,k)}break;case"textbox":case"default":d(this,k);break;case"list":case"checkedlist":if(this.host.jqxDropDownList){a(k.children()[0]).jqxDropDownList({width:c-10})}else{d(this,k)}break;case"bool":case"boolean":if(!this.host.jqxCheckBox){d(this,k)}break}}}}var b=a(this.filterrow.children()[0]);b.width(parseInt(e)+2);b.height(this.filterrowheight)},clearfilterrow:function(){this._disablefilterrow=true;var b=this.columns.records.length;var f=0;for(var d=0;d<b;d++){var c=this.columns.records[d];var g=a(this.filterrow[0].cells[d]);if(c.filterable){var e=function(i,j){var h=a(j.children()[0]);h.val("")};switch(c.filtertype){case"number":g.find("input").val("");break;case"date":if(this.host.jqxDateTimeInput){a(g.children()[0]).jqxDateTimeInput("setDate",null)}else{e(this,g)}break;case"textbox":case"default":e(this,g);break;case"list":if(this.host.jqxDropDownList){a(g.children()[0]).jqxDropDownList("clearSelection")}else{e(this,g)}break;case"checkedlist":if(this.host.jqxDropDownList){a(g.children()[0]).jqxDropDownList("checkAll",false)}else{e(this,g)}break;case"bool":case"boolean":if(!this.host.jqxCheckBox){e(this,g)}else{a(g.children()[0]).jqxCheckBox({checked:null})}break}}}this._disablefilterrow=false},_applyfilterfromfilterrow:function(){if(this._disablefilterrow==true){return}var z=this.columns.records.length;var C=this;for(var t=0;t<z;t++){var k=new a.jqx.filter();var u=this.columns.records[t];if(!u.filterable){continue}var f=C._getcolumntypebydatafield(u);var d=C._getfiltertype(f);var l=1;var D=true;var e=u.filtertype;var A=function(j,K,H){var i=true;if(j._filterwidget){var F=j._filterwidget.val();if(F!=""){var I="equal";if(K=="stringfilter"){var I="contains"}if(K!="stringfilter"){var J=0;if(F.indexOf(">")!=-1){I="greater_than";J=1}if(F.indexOf("<")!=-1){I="less_than";J=1}if(F.indexOf("=")!=-1){if(I=="greater_than"){I="greater_than_or_equal";J=2}else{if(I=="less_than"){I="less_than_or_equal";J=2}else{I="equal";J=1}}}if(J!=0){F=F.substring(J);if(F.length<1){return false}}}if(j.filtercondition!=undefined){I=j.filtercondition}var G=H.createfilter(K,F,I);H.addfilter(l,G)}else{i=false}}return i};switch(u.filtertype){case"date":if(u._filterwidget.jqxDateTimeInput){var p=u._filterwidget.jqxDateTimeInput("getRange");if(p!=null&&p.from!=null&&p.to!=null){var o="GREATER_THAN_OR_EQUAL";var r=new Date(0);r.setHours(0);r.setFullYear(p.from.getFullYear(),p.from.getMonth(),p.from.getDate());var q=new Date(0);q.setHours(0);q.setFullYear(p.to.getFullYear(),p.to.getMonth(),p.to.getDate());var y=k.createfilter(d,r,o);k.addfilter(0,y);var c="LESS_THAN_OR_EQUAL";var x=k.createfilter(d,q,c);k.addfilter(0,x)}else{D=false}}else{D=A(u,d,k)}break;case"number":if(u._filterwidget){var p=u._filterwidget.find("input").val();var h=u._filterwidget.find(".filter").jqxDropDownList("selectedIndex");var w=k.getoperatorsbyfiltertype(d)[h];if(C.updatefilterconditions){var E=C.updatefilterconditions(d,k.getoperatorsbyfiltertype(d));if(E!=undefined){k.setoperatorsbyfiltertype(d,E)}var w=k.getoperatorsbyfiltertype(d)[h]}var n=w=="NULL"||w=="NOT_NULL";var s=w=="EMPTY"||w=="NOT_EMPTY";if(p!=undefined&&p.length>0||n||s){y=k.createfilter(d,p,w,null,u.cellsformat,C.gridlocalization);k.addfilter(0,y)}else{D=false}}else{D=false}break;case"textbox":case"default":D=A(u,d,k);break;case"bool":case"boolean":if(u._filterwidget.jqxCheckBox){var p=u._filterwidget.jqxCheckBox("checked");if(p!=null){var o="equal";var m=k.createfilter(d,p,o);k.addfilter(l,m)}else{D=false}}else{D=A(u,d,k)}break;case"list":var g=u._filterwidget.jqxDropDownList("listBox");if(g.selectedIndex>0){var b=g.getItem(g.selectedIndex);var p=b.value;var o="equal";var m=k.createfilter(d,p,o);k.addfilter(l,m)}else{D=false}break;case"checkedlist":if(u._filterwidget.jqxDropDownList){var g=u._filterwidget.jqxDropDownList("listBox");var B=g.getCheckedItems();if(B.length==0){for(var v=1;v<g.items.length;v++){var p=g.items[v].value;var o="not_equal";var m=k.createfilter(d,p,o);k.addfilter(0,m)}D=true}else{if(B.length!=g.items.length){for(var v=0;v<B.length;v++){var p=B[v].value;var o="equal";var m=k.createfilter(d,p,o);k.addfilter(l,m)}}else{D=false}}}else{D=A(u,d,k)}break}if(!this._loading){if(D){this.addfilter(u.displayfield,k,false)}else{this.removefilter(u.displayfield,false)}}}if(!this._loading){this.applyfilters()}},_updatefilterrow:function(){var b=a('<div style="position: relative;" id="row00'+this.element.id+'"></div>');var f=0;var o=this.columns.records.length;var m=this.toThemeProperty("jqx-grid-cell");m+=" "+this.toThemeProperty("jqx-grid-cell-pinned");var q=o+10;var r=new Array();var n=this;this.filterrow[0].cells=r;b.height(this.filterrowheight);this.filterrow.children().detach();this.filterrow.append(b);if(!this._filterrowcache){this._filterrowcache=new Array()}var g=false;var d=new Array();for(var h=0;h<o;h++){var e=this.columns.records[h];var c=e.width;if(c<e.minwidth){c=e.minwidth}if(c>e.maxwidth){c=e.maxwidth}var l=a('<div style="overflow: hidden; position: absolute; height: 100%;" class="'+m+'"></div>');b.append(l);l.css("left",f);l.css("z-index",q--);l.width(c);l[0].left=f;if(!(e.hidden&&e.hideable)){f+=c}else{l.css("display","none")}r[r.length]=l[0];var k=true;if(this.groupable){var p=this.rowdetails?1:0;if(this.groups.length+p>h){k=false}}if(this.rowdetails&&h==0){k=false}if(k){if(e.filtertype=="custom"&&e.createfilterwidget){var i=function(){n._applyfilterfromfilterrow()};e.createfilterwidget(e,l,i)}else{if(e.filterable){if(this._filterrowcache[e.datafield]){g=true;l.append(this._filterrowcache[e.datafield]);e._filterwidget=this._filterrowcache[e.datafield]}else{this._addfilterwidget(e,l,c);d[e.datafield]=e._filterwidget}}}}}this._filterrowcache=d;if(a.jqx.browser.msie&&a.jqx.browser.version<8){b.css("z-index",q--)}b.width(parseInt(f)+2);this.filterrow.addClass(m);this.filterrow.css("border-top-width","1px");if(g){this._updatefilterrowui(true)}},_addfilterwidget:function(y,d,w){var B=this;var v="";for(var z=0;z<B.dataview.filters.length;z++){var t=B.dataview.filters[z];if(t.datafield&&t.datafield==y.datafield){v=t.filter.getfilters()[0].value;break}}var g=function(C,D){var f=a('<input autocomplete="off" type="textarea"/>');f[0].id=a.jqx.utilities.createId();f.addClass(C.toThemeProperty("jqx-input"));f.addClass(C.toThemeProperty("jqx-widget-content"));f.appendTo(D);f.width(w-10);f.height(C.filterrowheight-10);f.css("margin","4px");if(y.createfilterwidget){y.createfilterwidget(y,D,f)}y._filterwidget=f;f.focus(function(){C.focusedfilter=f});f.bind("keydown",function(E){if(E.keyCode=="13"){C._applyfilterfromfilterrow()}if(f[0]._writeTimer){clearTimeout(f[0]._writeTimer)}f[0]._writeTimer=setTimeout(function(){if(!C._loading){if(C["_oldWriteText"+f[0].id]!=f.val()){C._applyfilterfromfilterrow();C["_oldWriteText"+f[0].id]=f.val()}}},400);C.focusedfilter=f});C.host.removeClass("jqx-disableselect");C.content.removeClass("jqx-disableselect");f.val(v)};switch(y.filtertype){case"number":var k=a("<div></div>");k.width(d.width());k.height(this.filterrowheight);d.append(k);var w=d.width()-20;var o=function(D,E,f){var C=a('<input style="float: left;" autocomplete="off" type="textarea"/>');C[0].id=a.jqx.utilities.createId();C.addClass(B.toThemeProperty("jqx-input"));C.addClass(B.toThemeProperty("jqx-widget-content"));C.appendTo(D);C.width(E-10);C.height(B.filterrowheight-10);C.css("margin","4px");C.css("margin-right","2px");C.bind("keydown",function(F){if(F.keyCode=="13"){B._applyfilterfromfilterrow()}if(C[0]._writeTimer){clearTimeout(C[0]._writeTimer)}C[0]._writeTimer=setTimeout(function(){if(!B._loading){if(B["_oldWriteText"+C[0].id]!=C.val()){B._applyfilterfromfilterrow();B["_oldWriteText"+C[0].id]=C.val()}}},400);B.focusedfilter=C});C.val(v);return C};o(k,w);var x=B._getfiltersbytype("number");var p=a("<div class='filter' style='float: left;'></div>");p.css("margin-top","4px");p.appendTo(k);var h=2;if(y.filtercondition!=null){var e=x.indexOf(y.filtercondition);if(e!=-1){h=e}}p.jqxDropDownList({dropDownHorizontalAlignment:"right",enableBrowserBoundsDetection:true,selectedIndex:h,width:18,height:20,dropDownHeight:150,dropDownWidth:170,source:x,theme:B.theme});p.jqxDropDownList({selectionRenderer:function(f){return""}});p.jqxDropDownList("setContent","");p.find(".jqx-dropdownlist-content").hide();if(y.createfilterwidget){y.createfilterwidget(y,d,k)}y._filterwidget=k;p.bind("select",function(){if(y._filterwidget.find("input").val().length>0){B._applyfilterfromfilterrow()}});break;case"textbox":case"default":default:g(this,d);break;case"date":if(this.host.jqxDateTimeInput){var b=a("<div></div>");b.css("margin","4px");b.appendTo(d);b.jqxDateTimeInput({showFooter:true,formatString:y.cellsformat,selectionMode:"range",value:null,theme:this.theme,width:w-10,height:this.filterrowheight-10});if(y.createfilterwidget){y.createfilterwidget(y,d,b)}y._filterwidget=b;b.bind("valuechanged",function(f){B._applyfilterfromfilterrow();B.focusedfilter=null})}else{g(this,d)}break;case"list":case"checkedlist":if(this.host.jqxDropDownList){var n=this._getfilterdataadapter(y);var j=true;var p=a("<div></div>");p.css("margin","4px");var q=y.datafield;var r=y.filtertype=="checkedlist"?true:false;p.jqxDropDownList({checkboxes:r,source:n,autoDropDownHeight:j,theme:this.theme,width:w-10,height:this.filterrowheight-10,displayMember:y.displayfield,valueMember:q});p.appendTo(d);var m=p.jqxDropDownList("getItems");var c=p.jqxDropDownList("listBox");if(m.length<8){p.jqxDropDownList("autoDropDownHeight",true)}else{p.jqxDropDownList("autoDropDownHeight",false);j=false}if(r){p.jqxDropDownList({selectionRenderer:function(){return B.gridlocalization.filterselectstring}});var u=a('<span style="top: 2px; position: relative; color: inherit; border: none; background-color: transparent;">'+B.gridlocalization.filterselectstring+"</span>");u.addClass(this.toThemeProperty("jqx-item"));if(c!=undefined){if(!j){c.host.height(200)}c.insertAt(B.gridlocalization.filterselectallstring,0);p.jqxDropDownList("setContent",u);var i=true;var A=new Array();c.checkAll(false);c.host.bind("checkChange",function(D){p[0]._selectionChanged=true;if(!i){return}if(D.args.label!=B.gridlocalization.filterselectallstring){i=false;c.host.jqxListBox("checkIndex",0,true,false);var f=c.host.jqxListBox("getCheckedItems");var C=c.host.jqxListBox("getItems");if(f.length==1){c.host.jqxListBox("uncheckIndex",0,true,false)}else{if(C.length!=f.length){c.host.jqxListBox("indeterminateIndex",0,true,false)}}i=true}else{i=false;if(D.args.checked){c.host.jqxListBox("checkAll",false)}else{c.host.jqxListBox("uncheckAll",false)}i=true}})}}else{c.insertAt({label:this.gridlocalization.filterchoosestring,value:""},0);p.jqxDropDownList({selectedIndex:0})}if(y.createfilterwidget){y.createfilterwidget(y,d,p)}y._filterwidget=p;var l=p.jqxDropDownList("dropdownlistWrapper");if(y.filtertype=="list"){this.addHandler(p,"select",function(f){if(f.args&&f.args.type!="none"){B._applyfilterfromfilterrow();B.focusedfilter=null}})}else{this.addHandler(p,"close",function(f){if(p[0]._selectionChanged){B._applyfilterfromfilterrow();B.focusedfilter=null;p[0]._selectionChanged=false}})}}else{g(this,d)}break;case"bool":case"boolean":if(this.host.jqxCheckBox){var s=a('<div tabIndex=0 style="opacity: 0.99; position: absolute; top: 50%; left: 50%; margin-top: -7px; margin-left: -10px;"></div>');s.appendTo(d);s.jqxCheckBox({enableContainerClick:false,animationShowDelay:0,animationHideDelay:0,hasThreeStates:true,theme:this.theme,checked:null});if(y.createfilterwidget){y.createfilterwidget(y,d,s)}if(v===true||v=="true"){s.jqxCheckBox({checked:true})}else{if(v===false||v=="false"){s.jqxCheckBox({checked:false})}}y._filterwidget=s;s.bind("change",function(f){if(f.args){B.focusedfilter=null;B._applyfilterfromfilterrow()}})}else{g(this,d)}break}},_getfilterdataadapter:function(b){var c=this.source._source?true:false;if(!c){dataadapter=new a.jqx.dataAdapter(this.source,{autoBind:false,uniqueDataFields:[b.displayfield],async:false})}else{var d={localdata:this.source.records,datatype:this.source.datatype,async:false};dataadapter=new a.jqx.dataAdapter(d,{autoBind:false,async:false,uniqueDataFields:[b.displayfield]})}if(b.filteritems&&b.filteritems.length>0){var d={localdata:b.filteritems,datatype:this.source.datatype,async:false};dataadapter=new a.jqx.dataAdapter(d,{autoBind:false,async:false})}return dataadapter},refreshfilterrow:function(){this._updatefilterrowui();this._updatelistfilters()},_updatelistfilters:function(n){var o=this;var r=this.columns.records.length;for(var h=0;h<r;h++){var f=this.columns.records[h];if(f.filterable){if(f.filtertype=="list"||f.filtertype=="checkedlist"){var m=f._filterwidget;if(!n){if(f.filter==undefined){m.jqxDropDownList("renderSelection");continue}}else{var b=this._getfilterdataadapter(f);b.dataBind();var g=m.jqxDropDownList("getItems");var s=true;if(g.length!=b.records.length+1){s=false}if(s){for(var k=1;k<g.length;k++){if(g[k].label!=b.records[k-1][f.displayfield]){s=false;break}}}if(s){continue}}m.jqxDropDownList("dataBind");var l=f.filtertype=="checkedlist"?true:false;var g=m.jqxDropDownList("getItems");var c=m.jqxDropDownList("listBox");if(l){m.jqxDropDownList({selectionRenderer:function(){return o.gridlocalization.filterselectstring}});var e=a('<span style="top: 2px; position: relative; color: inherit; border: none; background-color: transparent;">'+this.gridlocalization.filterselectstring+"</span>");e.addClass(this.toThemeProperty("jqx-item"));c.insertAt(this.gridlocalization.filterselectallstring,0);m.jqxDropDownList("setContent",e);c.checkAll(false);if(f.filter){c.uncheckAll(false);var d=f.filter.getfilters();for(var k=0;k<c.items.length;k++){var q=c.items[k].label;a.each(d,function(){if(this.condition=="NOT_EQUAL"){return true}if(q==this.value){c.checkIndex(k,false,false)}})}c._updateCheckedItems();var p=c.getCheckedItems().length;if(c.items.length!=p&&p>0){c.host.jqxListBox("indeterminateIndex",0,true,false)}}}else{c.insertAt({label:this.gridlocalization.filterchoosestring,value:""},0);m.jqxDropDownList({selectedIndex:0})}if(g.length<8){m.jqxDropDownList("autoDropDownHeight",true)}else{m.jqxDropDownList("autoDropDownHeight",false)}}}}},_renderfiltercolumn:function(){var b=this;if(this.filterable){a.each(this.columns.records,function(c,d){if(b.autoshowfiltericon){if(this.filter){a(this.filtericon).show()}else{a(this.filtericon).hide()}}else{if(this.filterable){a(this.filtericon).show()}}})}},_getcolumntypebydatafield:function(e){var f=this;var d="string";var c=f.source.datafields||((f.source._source)?f.source._source.datafields:null);if(c){var h="";a.each(c,function(){if(this.name==e.displayfield){if(this.type){h=this.type}return false}});if(h){return h}}if(e!=null){if(this.dataview.cachedrecords==undefined){return d}var b=null;if(!this.virtualmode){if(this.dataview.cachedrecords.length==0){return d}b=this.dataview.cachedrecords[0][e.displayfield];if(b!=null&&b.toString()==""){return"string"}}else{a.each(this.dataview.cachedrecords,function(){b=this[e.displayfield];return false})}if(b!=null){if(typeof b=="boolean"){d="boolean"}else{if(a.jqx.dataFormat.isNumber(b)){d="number"}else{var g=new Date(b);if(g.toString()=="NaN"||g.toString()=="Invalid Date"){if(a.jqx.dataFormat){g=a.jqx.dataFormat.tryparsedate(b);if(g!=null){return"date"}else{d="string"}}else{d="string"}}else{d="date"}}}}}return d},_getfiltersbytype:function(b){var c=this;var d="";switch(b){case"number":case"float":case"int":d=c.gridlocalization.filternumericcomparisonoperators;break;case"date":d=c.gridlocalization.filterdatecomparisonoperators;break;case"boolean":case"bool":d=c.gridlocalization.filterbooleancomparisonoperators;break;case"string":default:d=c.gridlocalization.filterstringcomparisonoperators;break}return d},_updatefilterpanel:function(z,c,d){if(z==null||z==undefined){z=this}var e=z._getcolumntypebydatafield(d);var u=z._getfiltersbytype(e);if(!z.host.jqxDropDownList){alert("jqxdropdownlist is not loaded.");return}var s=a(c);var o=s.find("#filterclearbutton"+z.element.id);var i=s.find("#filterbutton"+z.element.id);var w=s.find("#filter1"+z.element.id);var t=s.find("#filter2"+z.element.id);var v=s.find("#filter3"+z.element.id);var r=s.find(".filtertext1"+z.element.id);var q=s.find(".filtertext2"+z.element.id);r.val("");q.val("");this.removeHandler(i,"click");this.addHandler(i,"click",function(){z._buildfilter(z,c,d);z._closemenu()});this.removeHandler(o,"click");this.addHandler(o,"click",function(){z._clearfilter(z,c,d);z._closemenu()});if(w.jqxDropDownList("source")!=u){w.jqxDropDownList({enableBrowserBoundsDetection:false,source:u});v.jqxDropDownList({enableBrowserBoundsDetection:false,source:u})}if(e=="boolean"||e=="bool"){w.jqxDropDownList({autoDropDownHeight:true,selectedIndex:0});v.jqxDropDownList({autoDropDownHeight:true,selectedIndex:0})}else{var f=false;if(u&&u.length){if(u.length<5){f=true}}w.jqxDropDownList({autoDropDownHeight:f,selectedIndex:2});v.jqxDropDownList({autoDropDownHeight:f,selectedIndex:2})}t.jqxDropDownList({selectedIndex:0});var m=d.filter;if(m!=null){var y=m.getfilterat(0);var x=m.getfilterat(1);var l=m.getoperatorat(0);var j=[];var b="";switch(e){case"number":case"int":case"float":case"decimal":b="numericfilter";j=m.getoperatorsbyfiltertype("numericfilter");break;case"boolean":case"bool":b="booleanfilter";j=m.getoperatorsbyfiltertype("booleanfilter");break;case"date":case"time":b="datefilter";j=m.getoperatorsbyfiltertype("datefilter");break;case"string":b="stringfilter";j=m.getoperatorsbyfiltertype("stringfilter");break}if(z.updatefilterconditions){var A=z.updatefilterconditions(b,j);if(A!=undefined){m.setoperatorsbyfiltertype(b,A);j=A}}var k=this.enableanimations?"default":"none";if(y!=null){var h=j.indexOf(y.comparisonoperator);var p=y.filtervalue;r.val(p);w.jqxDropDownList({selectedIndex:h,animationType:k})}if(x!=null){var g=j.indexOf(x.comparisonoperator);var n=x.filtervalue;q.val(n);v.jqxDropDownList({selectedIndex:g,animationType:k})}if(m.getoperatorat(0)==undefined){t.jqxDropDownList({selectedIndex:0,animationType:k})}else{if(m.getoperatorat(0)=="and"||m.getoperatorat(0)==0){t.jqxDropDownList({selectedIndex:0})}else{t.jqxDropDownList({selectedIndex:1})}}}if(z.updatefilterpanel){z.updatefilterpanel(w,v,t,r,q,i,o,m,b,j)}r.focus();setTimeout(function(){r.focus()},10)},_getfiltertype:function(b){var c="stringfilter";switch(b){case"number":case"int":case"float":case"decimal":c="numericfilter";break;case"boolean":case"bool":c="booleanfilter";break;case"date":case"time":c="datefilter";break;case"string":c="stringfilter";break}return c},_buildfilter:function(A,d,e){var x=a(d).find("#filter1"+A.element.id);var j=a(d).find("#filter2"+A.element.id);var u=a(d).find("#filter3"+A.element.id);var q=a(d).find(".filtertext1"+A.element.id);var p=a(d).find(".filtertext2"+A.element.id);var o=q.val();var m=p.val();var f=A._getcolumntypebydatafield(e);var r=A._getfiltersbytype(f);var h=x.jqxDropDownList("selectedIndex");var w=j.jqxDropDownList("selectedIndex");var g=u.jqxDropDownList("selectedIndex");var i=new a.jqx.filter();var z=null;var y=null;var c=A._getfiltertype(f);if(A.updatefilterconditions){var B=A.updatefilterconditions(c,i.getoperatorsbyfiltertype(c));if(B!=undefined){i.setoperatorsbyfiltertype(c,B)}}var b=false;var v=i.getoperatorsbyfiltertype(c)[h];var u=i.getoperatorsbyfiltertype(c)[g];var n=v=="NULL"||v=="NOT_NULL";var t=v=="EMPTY"||v=="NOT_EMPTY";if(v==undefined){v=i.getoperatorsbyfiltertype(c)[0]}if(u==undefined){u=i.getoperatorsbyfiltertype(c)[0]}if(o.length>0||n||t){z=i.createfilter(c,o,v,null,e.cellsformat,A.gridlocalization);i.addfilter(w,z);b=true}var l=u=="NULL"||u=="NOT_NULL";var s=u=="EMPTY"||u=="NOT_EMPTY";if(m.length>0||l||s){y=i.createfilter(c,m,u,null,e.cellsformat,A.gridlocalization);i.addfilter(w,y);b=true}if(b){var k=e.displayfield;this.addfilter(k,i,true)}else{this._clearfilter(A,d,e)}},_clearfilter:function(e,c,d){var b=d.displayfield;this.removefilter(b,true)},addfilter:function(d,e,c){if(this._loading){alert(this.loadingerrormessage);return false}var f=this.getcolumn(d);var b=this._getcolumn(d);if(f==undefined||f==null){return}f.filter=e;b.filter=e;this.dataview.addfilter(d,e);if(c==true&&c!=undefined){this.applyfilters()}},removefilter:function(d,c){if(this._loading){alert(this.loadingerrormessage);return false}var e=this.getcolumn(d);var b=this._getcolumn(d);if(e==undefined||e==null){return}if(e.filter==null){return}this.dataview.removefilter(d,e.filter);e.filter=null;b.filter=null;if(c==true||c!=undefined){this.applyfilters()}},applyfilters:function(){var c=false;if(this.dataview.filters.length>=0&&(this.virtualmode||!this.source.localdata)){if(this.source!=null&&this.source.filter){var f=-1;if(this.pageable){f=this.dataview.pagenum;this.dataview.pagenum=0}this.source.filter(this.dataview.filters,this.dataview.records,this.dataview.records.length);if(this.pageable){this.dataview.pagenum=f}}}if(!this.virtualmode){var b=this.selectedrowindexes;var d=this;if(b.length>0){if(this.dataview.filters&&this.dataview.filters.length==0){var e=new Array();a.each(b,function(){var g=d.getrowdata(this);if(g&&g.dataindex){e[e.length]=g.dataindex}});this.selectedrowindexes=e;this.selectedrowindex=this.selectedrowindexes.length>0?this.selectedrowindexes[0]:-1}}this.dataview.refresh();if(b.length>0){if(this.dataview.filters&&this.dataview.filters.length>0){var e=new Array();a.each(b,function(){var g=d.dataview._dataIndexToBoundIndex[this];if(g!=null){e[e.length]=g.boundindex}});this.selectedrowindexes=e;this.selectedrowindex=this.selectedrowindexes.length>0?this.selectedrowindexes[0]:-1}}}else{if(this.pageable){this.dataview.updateview();if(this.gotopage){this.gotopage(0)}}this.rendergridcontent(false,false);this._raiseEvent(13,{filters:this.dataview.filters});return}if(this.pageable){this.dataview.updateview();if(this.gotopage){this.gotopage(0);this.updatepagerdetails()}}this._updaterowsproperties();if(!this.groupable||(this.groupable&&this.groups.length==0)){this._rowdetailscache=new Array();this.virtualsizeinfo=null;this._pagescache=new Array();this.rendergridcontent(true,true);this._updatecolumnwidths();this._updatecellwidths();this._renderrows(this.virtualsizeinfo);if(this.showaggregates&&this._updatecolumnsaggregates){this._updatecolumnsaggregates()}}else{this._rowdetailscache=new Array();this._render(true,true,false,false,false);if(this.showfilterrow){this._updatefocusedfilter()}this._updatecolumnwidths();this._updatecellwidths();this._renderrows(this.virtualsizeinfo)}this._raiseEvent(13,{filters:this.dataview.filters})},getfilterinformation:function(){var d=new Array();for(var b=0;b<this.dataview.filters.length;b++){var c=this.getcolumn(this.dataview.filters[b].datafield);d[b]={filter:this.dataview.filters[b].filter,filtercolumn:c.datafield,filtercolumntext:c.text}}return d},clearfilters:function(b){var c=this;if(this.showfilterrow){this.clearfilterrow()}if(this.columns.records){a.each(this.columns.records,function(){c.removefilter(this.displayfield)})}if(b==true||b!=undefined){this.applyfilters()}},_destroyfilterpanel:function(){var e=a(a.find("#filterclearbutton"+this.element.id));var d=a(a.find("#filterbutton"+this.element.id));var h=a(a.find("#filter1"+this.element.id));var c=a(a.find("#filter2"+this.element.id));var g=a(a.find("#filter3"+this.element.id));var f=a(a.find(".filtertext1"+this.element.id));var b=a(a.find(".filtertext2"+this.element.id));if(f.length>0&&b.length>0){f.removeClass();b.removeClass();f.remove();b.remove()}if(e.length>0){e.jqxButton("destroy");d.jqxButton("destroy");this.removeHandler(e,"click");this.removeHandler(d,"click")}if(h.length>0){h.jqxDropDownList("destroy")}if(c.length>0){c.jqxDropDownList("destroy")}if(g>0){g.jqxDropDownList("destroy")}},_initfilterpanel:function(r,b,c,k){if(r==null||r==undefined){r=this}b[0].innerHTML="";var o=a("<div class='filter' style='margin-left: 7px;'></div>");b.append(o);var j=a("<div class='filter' style='margin-top: 3px; margin-bottom: 3px;'></div>");j.text(r.gridlocalization.filtershowrowstring);var p=a("<div class='filter' id='filter1"+r.element.id+"'></div>");var g=a("<div class='filter' id='filter2"+r.element.id+"' style='margin-bottom: 3px;'></div>");var n=a("<div class='filter' id='filter3"+r.element.id+"'></div>");var d=r._getcolumntypebydatafield(c);if(!p.jqxDropDownList){alert("jqxdropdownlist is not loaded.");return}var l=r._getfiltersbytype(d);var h=a("<div class='filter'><input class='filtertext1"+r.element.id+"' style='height: 20px; margin-top: 3px; margin-bottom: 3px;' type='text'></input></div>");h.find("input").addClass(this.toThemeProperty("jqx-input"));h.find("input").addClass(this.toThemeProperty("jqx-widget-content"));h.find("input").addClass(this.toThemeProperty("jqx-rc-all"));h.find("input").width(k-15);var i=a("<div class='filter'><input class='filtertext2"+r.element.id+"' style='height: 20px; margin-top: 3px;' type='text'></input></div>");i.find("input").addClass(this.toThemeProperty("jqx-input"));i.find("input").addClass(this.toThemeProperty("jqx-widget-content"));i.find("input").addClass(this.toThemeProperty("jqx-rc-all"));i.find("input").width(k-15);var f=a("<div class='filter' style='height: 25px; margin-left: 20px; margin-top: 7px;'></div>");var e=a('<span tabIndex=0 id="filterbutton'+r.element.id+'" class="filterbutton" style="padding: 4px 12px; margin-left: 2px;">'+r.gridlocalization.filterstring+"</span>");f.append(e);var q=a('<span tabIndex=0 id="filterclearbutton'+r.element.id+'" class="filterclearbutton" style="padding: 4px 12px; margin-left: 5px;">'+r.gridlocalization.filterclearstring+"</span>");f.append(q);e.jqxButton({height:20,theme:r.theme});q.jqxButton({height:20,theme:r.theme});var s=function(u){if(u){if(u.text().indexOf("case sensitive")!=-1){var t=u.text();t=t.replace("case sensitive","match case");u.text(t)}u.css("font-family",r.host.css("font-family"));u.css("font-size",r.host.css("font-size"));return u}return""};o.append(j);o.append(p);p.jqxDropDownList({enableBrowserBoundsDetection:false,selectedIndex:2,width:k-15,height:20,dropDownHeight:150,dropDownWidth:k-15,selectionRenderer:s,source:l,theme:r.theme});o.append(h);var m=new Array();m[0]=r.gridlocalization.filterandconditionstring;m[1]=r.gridlocalization.filterorconditionstring;g.jqxDropDownList({enableBrowserBoundsDetection:false,autoDropDownHeight:true,selectedIndex:0,width:60,height:20,source:m,selectionRenderer:s,theme:r.theme});o.append(g);n.jqxDropDownList({enableBrowserBoundsDetection:false,selectedIndex:2,width:k-15,height:20,dropDownHeight:150,dropDownWidth:k-15,selectionRenderer:s,source:l,theme:r.theme});o.append(n);o.append(i);o.append(f);if(r.updatefilterpanel){r.updatefilterpanel(p,n,g,h,i,e,q,null,null,l)}}});a.jqx.filter=function(){this.operator="and";var h=0;var e=1;var k=["EMPTY","NOT_EMPTY","CONTAINS","CONTAINS_CASE_SENSITIVE","DOES_NOT_CONTAIN","DOES_NOT_CONTAIN_CASE_SENSITIVE","STARTS_WITH","STARTS_WITH_CASE_SENSITIVE","ENDS_WITH","ENDS_WITH_CASE_SENSITIVE","EQUAL","EQUAL_CASE_SENSITIVE","NULL","NOT_NULL"];var m=["EQUAL","NOT_EQUAL","LESS_THAN","LESS_THAN_OR_EQUAL","GREATER_THAN","GREATER_THAN_OR_EQUAL","NULL","NOT_NULL"];var n=["EQUAL","NOT_EQUAL","LESS_THAN","LESS_THAN_OR_EQUAL","GREATER_THAN","GREATER_THAN_OR_EQUAL","NULL","NOT_NULL"];var g=["EQUAL","NOT_EQUAL"];var f=new Array();var l=new Array();this.evaluate=function(s){var q=true;for(var r=0;r<f.length;r++){var p=f[r].evaluate(s);if(r==0){q=p}else{if(l[r]==e||l[r]=="or"){q=q||p}else{q=q&&p}}}return q};this.getfilterscount=function(){return f.length};this.setoperatorsbyfiltertype=function(p,q){switch(p){case"numericfilter":m=q;break;case"stringfilter":k=q;break;case"datefilter":n=q;break;case"booleanfilter":g=q;break}};this.getoperatorsbyfiltertype=function(p){var q=new Array();switch(p){case"numericfilter":q=m.slice(0);break;case"stringfilter":q=k.slice(0);break;case"datefilter":q=n.slice(0);break;case"booleanfilter":q=g.slice(0);break}return q};var j=function(){var p=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(p()+"-"+p()+"-"+p())};this.createfilter=function(t,q,s,r,p,u){if(t==null||t==undefined){return null}switch(t){case"numericfilter":return new i(q,s.toUpperCase());case"stringfilter":return new o(q,s.toUpperCase());case"datefilter":return new c(q,s.toUpperCase(),p,u);case"booleanfilter":return new d(q,s.toUpperCase());case"custom":return new b(q,s.toUpperCase(),r)}return null};this.getfilters=function(){var p=new Array();for(var q=0;q<f.length;q++){var r={value:f[q].filtervalue,condition:f[q].comparisonoperator,operator:l[q],type:f[q].type};p[q]=r}return p};this.addfilter=function(p,q){f[f.length]=q;q.key=j();l[l.length]=p};this.removefilter=function(q){for(var p=0;p<f.length;p++){if(f[p].key==q.key){f.splice(p,1);l.splice(p,1);break}}};this.getoperatorat=function(p){if(p==undefined||p==null){return null}if(p<0||p>f.length){return null}return l[p]};this.setoperatorat=function(q,p){if(q==undefined||q==null){return null}if(q<0||q>f.length){return null}l[p]=p};this.getfilterat=function(p){if(p==undefined||p==null){return null}if(p<0||p>f.length){return null}return f[p]};this.setfilterat=function(p,q){if(p==undefined||p==null){return null}if(p<0||p>f.length){return null}q.key=j();f[p]=q};this.clear=function(){f=new Array();l=new Array()};var o=function(q,p){this.filtervalue=q;this.comparisonoperator=p;this.type="stringfilter";this.evaluate=function(u){var t=this.filtervalue;var r=this.comparisonoperator;if(u==null||u==undefined){if(r=="NULL"){return true}return false}var v="";try{v=u.toString()}catch(s){return true}switch(r){case"EQUAL":return a.jqx.string.equalsIgnoreCase(v,t);case"EQUAL_CASE_SENSITIVE":return a.jqx.string.equals(v,t);case"NOT_EQUAL":return !a.jqx.string.equalsIgnoreCase(v,t);case"NOT_EQUAL_CASE_SENSITIVE":return !a.jqx.string.equals(v,t);case"CONTAINS":return a.jqx.string.containsIgnoreCase(v,t);case"CONTAINS_CASE_SENSITIVE":return a.jqx.string.contains(v,t);case"DOES_NOT_CONTAIN":return !a.jqx.string.containsIgnoreCase(v,t);case"DOES_NOT_CONTAIN_CASE_SENSITIVE":return !a.jqx.string.contains(v,t);case"EMPTY":return v=="";case"NOT_EMPTY":return v!="";case"NOT_NULL":return v!=null;case"STARTS_WITH":return a.jqx.string.startsWithIgnoreCase(v,t);case"ENDS_WITH":return a.jqx.string.endsWithIgnoreCase(v,t);case"ENDS_WITH_CASE_SENSITIVE":return a.jqx.string.endsWith(v,t);case"STARTS_WITH_CASE_SENSITIVE":return a.jqx.string.startsWith(v,t);default:return false}}};var d=function(q,p){this.filtervalue=q;this.comparisonoperator=p;this.type="booleanfilter";this.evaluate=function(t){var s=this.filtervalue;var r=this.comparisonoperator;if(t==null||t==undefined){if(r=="NULL"){return true}return false}var u=t;switch(r){case"EQUAL":return u==s||u.toString()==s.toString();case"NOT_EQUAL":return u!=s&&u.toString()!=s.toString();default:return false}}};var i=function(q,p){this.filtervalue=q;this.comparisonoperator=p;this.type="numericfilter";this.evaluate=function(u){var t=this.filtervalue;var r=this.comparisonoperator;if(u==null||u==undefined){if(r=="NOT_NULL"){return false}if(r=="NULL"){return true}else{return false}}else{if(r=="NULL"){return false}if(r=="NOT_NULL"){return true}}var v=u;try{v=parseFloat(v)}catch(s){if(u.toString()!=""){return false}}switch(r){case"EQUAL":return v==t;case"NOT_EQUAL":return v!=t;case"GREATER_THAN":return v>t;case"GREATER_THAN_OR_EQUAL":return v>=t;case"LESS_THAN":return v<t;case"LESS_THAN_OR_EQUAL":return v<=t;default:return true}}};var c=function(s,q,r,v){this.filtervalue=s;this.type="datefilter";if(r!=undefined&&v!=undefined){var t=a.jqx.dataFormat.parsedate(s,r,v);if(t!=null){this.filterdate=t}else{var p=a.jqx.dataFormat.tryparsedate(s,v);if(p!=null){this.filterdate=p}}}else{var u=new Date(s);if(u.toString()=="NaN"||u.toString()=="Invalid Date"){this.filterdate=a.jqx.dataFormat.tryparsedate(s)}else{this.filterdate=u}}this.comparisonoperator=q;this.evaluate=function(D){var E=this.filtervalue;var B=this.comparisonoperator;if(D==null||D==undefined){if(B=="NOT_NULL"){return false}if(B=="NULL"){return true}else{return false}}else{if(B=="NULL"){return false}if(B=="NOT_NULL"){return true}}var w=new Date();w.setFullYear(1900,0,1);w.setHours(12,0,0,0);try{var z=new Date(D);if(z.toString()=="NaN"||z.toString()=="Invalid Date"){D=a.jqx.dataFormat.tryparsedate(D)}else{D=z}w=D}catch(A){if(D.toString()!=""){return false}}if(this.filterdate!=null){E=this.filterdate}else{if(E.indexOf(":")!=-1||!isNaN(parseInt(E))){var C=new Date(w);C.setHours(12,0,0,0);var x=E.split(":");for(var y=0;y<x.length;y++){if(y==0){C.setHours(x[y])}if(y==1){C.setMinutes(x[y])}if(y==2){C.setSeconds(x[y])}}E=C}}if(w==null){w=""}switch(B){case"EQUAL":return w.toString()==E.toString();case"NOT_EQUAL":return w.toString()!=E.toString();case"GREATER_THAN":return w>E;case"GREATER_THAN_OR_EQUAL":return w>=E;case"LESS_THAN":return w<E;case"LESS_THAN_OR_EQUAL":return w<=E;default:return true}}};var b=function(q,p,r){this.filtervalue=q;this.comparisonoperator=p;this.evaluate=function(t,s){return r(this.filtervalue,t,this.comparisonoperator)}}}})(jQuery);